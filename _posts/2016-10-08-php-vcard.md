---
layout: post
title:  "PHP导出VCF格式数据"
categories: PHP
tags:  PHP vcard
---

* content
{:toc}


php生成vcard文件




##问题描述

最近公司有个新的需求，要求将数据库的用户表的内容，转化为vcf格式。这样的话就可以直接导入的通讯录。
在github上使用最多的是[v-Card-parser](https://github.com/nuovo/vCard-parser)和[vcard](https://github.com/jeroendesloovere/vcard)，有兴趣的可以研究下；




因为只需要实现导出功能，所以就找了一个最简单的类。类代码[vcard](https://github.com/facine/vCard/blob/master/vCard.class.php)

但是这个类只能导出一个电话号码，于是重写了他的下载download()函数；
```php
function  downloads($vcards,$filename){

    header("Content-type: text/directory");
    header("Content-Disposition: attachment; filename=" . $filename . ".vcf");
    header("Pragma: public");
    foreach ($vcards as $vcard) {
        if (!$vcard->card) {
            $vcard->build();
        }
        echo $vcard->card;
    }
    return TRUE;
}
```
导出文件的格式如下：


```
BEGIN:VCARD
VERSION:3.0
CLASS:PUBLIC
PRODID:-//class_vCard from WhatsAPI//NONSGML Version 1//EN
REV:2016-10-08 11:31:42
FN:zhangliyangf 111
N:111;zhangliyangf;;;

EMAIL;type=INTERNET,pref:12131@qq.com
TEL;type=CELL,voice:18355519883
TZ:+0800
END:VCARD
BEGIN:VCARD
VERSION:3.0
CLASS:PUBLIC
PRODID:-//class_vCard from WhatsAPI//NONSGML Version 1//EN
REV:2016-10-08 11:31:42
FN:zhangliyangf 111
N:111;zhangliyangf;;;

EMAIL;type=INTERNET,pref:12131@qq.com
TEL;type=CELL,voice:18355519882
TZ:+0800
END:VCARD
BEGIN:VCARD
VERSION:3.0
CLASS:PUBLIC
PRODID:-//class_vCard from WhatsAPI//NONSGML Version 1//EN
REV:2016-10-08 11:31:42
FN:zhangliyangf 111
N:111;zhangliyangf;;;

EMAIL;type=INTERNET,pref:12131@qq.com
TEL;type=CELL,voice:18355519881
TZ:+0800
END:VCARD
```
